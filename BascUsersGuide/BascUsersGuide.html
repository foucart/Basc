<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="css/bascug.css">
        <script src="js/vendor/modernizr-2.6.1.min.js"></script>
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
        </script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.0.min.js"><\/script>')</script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>

        <!-- Add your site or application content here -->
        <div class="body_content_container" style="background-color: #020202;">
            <span style="color: #FFFFFF;">
                <h2>BASC: Best Approximation by Splines under Constraints</h2>
                <h3>by Simon Foucart and Vladlena Powers</h3>
            </span>
        </div>
        <!-- Contents -->
        <div class="body_content_container">
            <h1>Contents</h1>
            <ul>
                <li>
                    <a onclick="
                        $('#guide_introduction').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $(window).scrollTop($('#guide_introduction').offset().top);">Introduction</a>
                </li>
                <li>
                    <a onclick="
                        $('#guide_syntax').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $(window).scrollTop($('#guide_syntax').offset().top);">Syntax</a>
                </li>
                <li>
                    <a onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);         
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);">Description</a>
                </li>
                <li>
                    <a onclick="
                        $('#guide_interactive_guide').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $(window).scrollTop($('#guide_interactive_guide').offset().top);">Interactive Guide</a>
                </li>
                <li>
                    <a onclick="
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $(window).scrollTop($('#guide_examples').offset().top);">Examples</a>
                </li>
                <li>
                    <a onclick="
                        $('#guide_advanced_examples').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $(window).scrollTop($('#guide_advanced_examples').offset().top);">Advanced Examples</a>
                </li>
                <li>
                    <a onclick="
                        $('#guide_references').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $(window).scrollTop($('#guide_references').offset().top);">References</a>
                </li>
            </ul>
        </div>
        <!-- Introduction (guide_introduction)-->
        <div class="body_content_container">
            <h1 class="container_title" id="guide_introduction">Introduction</h1>
            <div class="content_box">
                <p>
This document illustrates how to use the MATLAB package <b>Basc</b> 
(<b>B</b>est <b>A</b>pproximation by <b>S</b>plines under <b>C</b>onstraints, version 1.0)
by calling the generic command with different options.
All the theoretical justifications are to be found in [1].
The package relies heavily on CVX [2] and Chebfun [3],
which are included in the downloadable folder.
CVX and Chebfun need to be activated from the folder "/basc_v1.0" by typing <span class="matlab_text">basc_setup</span> 
at MATLAB's prompt.
Then, for later convenience, we define
                </p>
                <div class="code_box">x = chebfun(<span class="string">'x'</span>);
LW = <span class="string">'LineWidth'</span>; lw = 2; POS = <span class="string">'Position'</span>; pos = [-50 -50 1366 768];
FS = <span class="string">'FontSize'</span>; fs = 16; LOC = <span class="string">'Location'</span>; loc = <span class="string">'northoutside'</span>; BX = <span class="string">'box'</span>; bx = <span class="string">'off'</span>;</div>
                <p>
Given a target function $F$ and a linear space $\mathcal{S}$ of
approximants, the general problem considered here consists
in minimizing
$\|F-P\|$
over all $P \in \mathcal{S}$
for various norms on the interval $[-1,1]$
under various convex constraints.
In all instances,
the problem is translated to the level of Chebyshev coefficients using
Chebfun [3], transformed into a semidefinite program,
and solved using CVX [2].
                </p>
            </div>
        </div>
        <!-- Syntax (guide_syntax)-->
        <div class="body_content_container">
            <h1 class="container_title" id="guide_syntax">Syntax</h1>
            <div class="content_box">
                <ul>
                    <li>
                        <tt>
                            minimum = basc(F, degP)
                        </tt>
                    </li>
                    <li>
                        <tt>
                            minimum = basc(F, degP, options)
                        </tt>
                    </li>
                    <li>
                        <tt>
                            [minimum] = basc(F, degP, options)
                        </tt>
                    </li>
                    <li>
                        <tt>
                            [minimum, minimizer] = basc(F, degP, options)
                        </tt>
                    </li>
                    <li>
                        <tt>
                            [minimum, minimizer, status] = basc(F, degP, ...)
                        </tt>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Description (guide_parameter_desc)-->
        <div class="body_content_container">
            <h1 class="container_title" id="guide_parameter_desc">Description</h1>
            <div class="content_box">
                <p>
                    <b>Basc</b> finds the best approximant to a target function, entered as a chebfun, by a polynomial or spline of given degree(s), entered as a single integer or as
                    a row-vector of integers, under a certain number of convex constraints.<br><br>
                    
                    [minimum, minimizer, status] = basc(F, degP)
		    <br>outputs<br>

                    <b>minimum</b> - the error of best approximation<br>
                    <b>minimizer</b> - the best approximant returned as a chebfun<br>
                    <b>status</b> - reliability of the result (duplicates cvx_status)
	            <br><br> 
		    
		    [minimum, minimizer, status] = basc(F, degP,options)
		    <br> 
		    performs the minimization under additional constraints. 
		    These optional constraints are usually entered right after the name of the corresponding field. <br><br>

                    The optional inputs available in <b>Basc</b> are listed in the table below.<br>
                </p>
                <table class="desc_table" border="1" style="width:100%">
                    <tr>
                        <td>Field</td>
                        <td>Explanation</td> 
                        <td>Example</td>
                    </tr>
                    <!--norm-->
                    <tr>
                        <td>norm</td>
                        <td>a norm index either equal to infinity or to an even integer, the default value is inf</td>
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_norm').offset().top);">basc(F,degP,'norm',6)</a><br>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_norm').offset().top);">basc(F,degP)</a>
                        </td>
                    </tr>
                    <!--weight-->
                    <tr>
                        <td>weight</td>
                        <td>a weight function entered as a chebfun after the field 'weight', the default value is chebfun('1')</td>
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_weight').offset().top);">basc(F,degP,'weight',chebfun('x.^2'))</a>
                        </td>
                    </tr>
                    <!--breakpoints-->
                    <tr>
                        <td>bkpts</td>
                        <td>a set of breakpoints in (-1,1) entered as a row-vector, the default value is [] (i.e., no breakpoints)</td>
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_breakpoints').offset().top);">basc(F,degP,'bkpts',[-1/2 0 1/2])</a>
                        </td>
                    </tr>
                    <!--smoothness-->
                    <tr>
                        <td>smoothness</td>
                        <td>a set of smoothness parameters equal to -1,0,1,2, etc. (one for each breakpoint) entered as a row-vector, the default values is [-1 ... -1] (i.e., the approximant is noncontinuous)</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_smoothness').offset().top);">basc(F,degP,'bkpts',[-1/2 0 1/2],'smoothness',[0 1 0])</a>
                        </td>
                    </tr>
                    <!--parity-->
                    <tr>
                        <td>parity</td>
                        <td>a requirement on the parity of the approximant entered as 'even' or 'odd' </td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_parity').offset().top);">basc(F,degP,'parity','even')</a>
                        </td>
                    </tr>
                    <!--interpolation-->
                    <tr>
                        <td>interpolation</td>
                        <td>a set of interpolation conditions entered as a cell of cells, with each inner cell containing first the index of the derivative to be interpolated, then either a 2-row-matrix whose first row contains the interpolation nodes and second row contains the interpolation data or a row-vector containing only the nodes if the data are the values of the appropriate derivative of the function at these nodes</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_interpolation0').offset().top);">basc(F, degP, 'interpolation', {{0, [-1/2 0 1/2;0 0 0]}})</a><br>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_interpolation1').offset().top);">basc(F, degP, 'interpolation', {{0, [-1/2 0 1/2]}})</a>
                        </td>
                    </tr>
                    <!--upper range-->
                    <tr>
                        <td>upper range</td>
                        <td>a set of upper range conditions entered as a cell of cells, with each inner cell containing first the index of the derivative to be upper-bounded then the upper-bound function as a chebfun</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_upper_range').offset().top);">basc(F,degP,'upper range',{{0,chebfun('3-x.^2')},{1,chebfun('1')}})</a>
                        </td>
                    </tr>
                    <!--lower range-->
                    <tr>
                        <td>lower range</td>
                        <td>a set of lower range conditions entered  as a cell of cells, with each inner cell containing first the index of the derivative to be lower-bounded then the lower-bound function as a chebfun</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_lower_range').offset().top);">basc(F,degP,'lower range',{{0,chebfun('x.^2-1')},{1,chebfun('-1')}})</a>
                        </td>
                    </tr>
                    <!--shape-->
                    <tr>
                        <td>shape</td>
                        <td>a set of shape conditions entered as a cell of cells, with each inner cell containing first the index of the derivative whose sign pattern is imposed then a function with the appropriate sign pattern entered as a chebfun</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_shape').offset().top);">basc(F,degP,'shape',{{2,chebfun('x')}})</a>
                        </td>
                    </tr>
                    <!--objective function-->
                    <tr>
                        <td>objective</td>
                        <td>a set of parameters describing the objective function being minimized, they are entered as a cell whose first element is a norm index r >=1 and the other elements are cells containing a derivative index followed by an attached weight, the default is {inf,{0,1}}</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_obj_fun').offset().top);">basc(F,n,'objective',{inf,{0,1},{1,1/3}})</a>
                        </td>
                    </tr>
                    <!--side-->
                    <tr>
                        <td><i>side</i></td>
                        <td>a parameter entered as 'above' or 'below' imposing the position of the approximant with respect to the target function <br>(the field name should not be included)</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_side').offset().top);">basc(F,degP,'above')</a><br>which is a shortcut for 
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_side').offset().top);">basc(F,degP,'lower range',{{0,F}})
                    </tr>
                    <!--sign-->
                    <tr>
                        <td><i>sign</i></td>
                        <td>a parameter entered as 'positive' or 'negative' imposing the sign of the approximant <br>(the field name should not be included)</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_sign').offset().top);">basc(F,degP,'positive')</a><br>which is a shortcut for 
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_sign').offset().top);">basc(F,degP,'lower range',{{0,chebfun('0')}})</a>
                        </td>
                    </tr>
                    <!--monotonicity-->
                    <tr>
                        <td><i>monotonicity</i></td>
                        <td>a parameter entered as 'increasing' or 'decreasing' imposing the monotonicity of the approximant<br>(the field name should not be included)</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_monotonicity').offset().top);">basc(F,degP,'decreasing')</a><br>which is a shortcut for 
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_monotonicity').offset().top);">basc(F,degP,'shape',{{1,chebfun('-1')}})</a>
                        </td>
                    </tr>
                    <!--concavity-->
                    <tr>
                        <td><i>concavity</i></td>
                        <td>a parameter entered as 'convex' or 'concave' imposing the concavity of the approximant <br>(the field name should not be included) </td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_concavity').offset().top);">basc(F,degP,'convex')</a><br>which is a shortcut for 
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_concavity').offset().top);">basc(F,degP,'shape',{{2,chebfun('1')}})</a>
                        </td>
                    </tr>
                    <!--quiet-->
                    <tr>
                        <td>quiet</td>
                        <td>a parameter to suppress screen output from CVX entered as true or false, the default value is true</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_quiet').offset().top);">basc(F,degP,'quiet',false)</a>
                        </td>
                    </tr>
                    <!--precision-->
                    <tr>
                        <td>precision</td>
                        <td>a parameter to select CVX's precision entered as 'low', 'medium', 'default', 'high', or 'best', the default value is of CVX's default precision</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_precision').offset().top);">basc(F,degP,'precision','high')</a>
                        </td>
                    </tr>
                    <!--solver-->
                    <tr>
                        <td>solver</td>
                        <td>a parameter entered (without CVX's professional license) as 'SDPT3' or 'SeDuMi' to select CVX's solver, the default value is CVX's default solver</td> 
                        <td>
                            <a onclick="
                                $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                                $(window).scrollTop($('#examples_solver').offset().top);">basc(F,degP,'solver','sedumi')</a>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <!-- Interactive Guide (guide_interactive_guide)-->
        <div class="body_content_container">
            <h1 class="container_title" id="guide_interactive_guide">Interactive Guide</h1>
            <div class="content_box">
                <div style="height: 120px">
                    The interactive guide below gives the opportunity to try some combinations of input parameters for <b>Basc</b>.<br><br>
                    <table border="0" style="width:100%;">
                        <tr>
                            <td>
                                target function
                                <select id="ig_function_menu">
                                    <!--<option value=0>Function</option>-->
                                    <option value=1>classic chebfun</option>
                                    <option value=2>piecewise chebfun</option>
                                </select>
                            </td>
                            <td>
                                approximant
                                <select id="ig_approximant_menu">
                                    <!--<option value=0>Approximant</option>-->
                                    <option value=1>classic chebfun</option>
                                    <option value=2>piecewise chebfun</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                smoothness 
                                <select id="ig_smoothness_menu">
                                    <option value=2>noncontinuous</option>
                                    <option value=0>continuous</option>
                                    <option value=1>differentiable</option>
                                </select>
                            </td>
                            <td>
                                interpolation
                                <select id="ig_interpolation_menu">
                                    <option value=0>yes</option>
                                    <option value=1>no</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                
                            </td>
                            <td>
                                <button id="ig_apply_button" style="float:right;" type="button" onclick="apply_button_press()">Apply</button>
                                <div style='width: 20px; float: right;'></div>
                                <div id="hide_button_div">
                                    <button id="ig_hide_button" style="float:right;" type="button" onclick="hide_button_press()">Hide Example</button>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div id="ig_polyn_polynom_notcont_without">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the function $F(x) = \sin(x)$ 
                            by polynomials of degree $n \le 1$ in the max-norm.
                        </p>
                        <div class="code_box">n = 1; F = sin(x);
[e,P]=basc(F,n);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_01.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_polyn_polynom_notcont_with">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ 
                            by polynomials of degree $n \le 4$ in the max-norm with interpolation constraints
                            such that the approximant has values of $10$, $-10$ and $10$ 
                            at points $-1/2$, $0$ and $1/2$ respectively.
                        </p>
                        <div class="code_box">n = 4; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P]=basc(F,n,<span class="string">'interpolation'</span>, {{0, [-1/2 0 1/2; 10 -10 10]}});
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_02.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_polyn_spline_notcont_without">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ 
                            by splines of degree $0$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ in the max-norm.
                        </p>
                        <div class="code_box">F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P]=basc(F,[0 0 0 0 0 0],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3]);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_03.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_polyn_spline_cont_without">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ 
                            by splines of degrees $3$, $0$, $3$, $0$, $3$ and $0$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with the smoothness conditions such that the approximant is continuous.
                        </p>
                        <div class="code_box">F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P]=basc(F,[3 0 3 0 3 0],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3],<span class="string">'smoothness'</span>,[0 0 0 0 0]);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_04.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_polyn_spline_diff_without">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ 
                            by splines of degrees $3$, $0$, $3$, $0$, $3$ and $0$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with the smoothness conditions such that the approximant is differentiable.
                        </p>
                        <div class="code_box">F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P]=basc(F,[3 0 3 0 3 0],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3],<span class="string">'smoothness'</span>,[1 1 1 1 1]);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_05.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_polyn_spline_cont_with">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the function $F(x) = T_{10}(x)$ 
                            by splines of degrees $3$, $0$, $3$, $0$, $3$ and $0$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with the smoothness and interpolation constraints such that the approximant 
                            is continuous and intersects with the target function at points $-1/2$, $0$ and $1/2$.
                        </p>
                        <div class="code_box">F = chebpoly(10);
[e,P]=basc(F,[3 0 3 0 3 0],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3],<span class="string">'smoothness'</span>,[0 0 0 0 0],<span class="string">'interpolation'</span>, {{0, [-1/2 0 1/2]}});
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_06.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_polyn_spline_diff_with">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the function $F(x) = T_{10}(x)$ 
                            by splines of degrees $3$, $0$, $3$, $0$, $3$ and $0$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with the smoothness and interpolation constraints such that the approximant 
                            is differentiable and intersects with the target function at points $-1/2$, $0$ and $1/2$.
                        </p>
                        <div class="code_box">F = chebpoly(10);
[e,P]=basc(F,[3 0 3 0 3 0],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3],<span class="string">'smoothness'</span>,[1 1 1 1 1],<span class="string">'interpolation'</span>, {{0, [-1/2 0 1/2]}});
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_07.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_spline_polynom_notcont_without">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the spline function $F(x) = \lvert\exp(x)\sin(8x)\rvert$ 
                            by polynomials of degree $n \le 3$ in the max-norm.
                        </p>
                        <div class="code_box">n = 3; F = abs(exp(x).*sin(8*x));
[e,P]=basc(F,n);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_08.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_spline_polynom_notcont_with">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the spline function $F(x) = \lvert\exp(x)\sin(8x)\rvert$ 
                            by polynomials of degree $n \le 5$ in the max-norm with interpolation constraints such that
                            the approximant intersects with the target function at points $0$ and $1/2$.
                        </p>
                        <div class="code_box">n = 5; F = abs(exp(x).*sin(8*x));
[e,P]=basc(F,n,<span class="string">'interpolation'</span>, {{0, [0 1/2]}});
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_09.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                    </div>
                <div id="ig_spline_spline_notcont_without">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the spline function $F(x) = \max(\sin(20x),\exp(x-1))$ 
                            by splines of degrees $3$, $0$, $3$, $0$, $3$ and $0$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm.
                        </p>
                        <div class="code_box">f = sin(20*x);
g = exp(x-1);
F = max(f,g);
[e,P]=basc(F,[0 3 0 3 0 3],<span class="string">'bkpts'</span>,[-1/3 -2/3 0 1/3 2/3]);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_10.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_spline_spline_notcont_with">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the spline function $F(x) = -10\lvert x\rvert$ 
                            by splines of degrees $0$, $1$, $0$, $1$, $0$ and $1$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with interpolation constraints such that the approximant 
                            has values $10$, $-10$ and $10$ at points $-1/2$, $0$ and $1/2$ respectively.
                        </p>
                        <div class="code_box">F = -10*abs(x);
[e,P]=basc(F,[0 1 0 1 0 1],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3],<span class="string">'interpolation'</span>, {{0, [-1/2 0 1/2; 10 -10 10]}});
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_11.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_spline_spline_cont_without">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the spline function $F(x) = -10\lvert x\rvert$ 
                            by splines of degrees $0$, $1$, $0$, $1$, $0$ and $1$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with smoothness conditions such that
                            the approximant is continuous.
                        </p>
                        <div class="code_box">F = -10*abs(x);
[e,P]=basc(F,[0 1 0 1 0 1],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3],<span class="string">'smoothness'</span>,[0 0 0 0 0]);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_12.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_spline_spline_diff_without">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the spline function $F(x) = -10\lvert x\rvert$ 
                            by splines of degrees $2$, $1$, $0$, $2$, $0$ and $2$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with smoothness conditions such that
                            the approximant is differentiable.
                        </p>
                        <div class="code_box">F = -10*abs(x);
[e,P]=basc(F,[2 1 0 2 0 2],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3],<span class="string">'smoothness'</span>,[1 1 1 1 1]);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_13.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_spline_spline_cont_with">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the spline function $F(x) = -10\lvert x\rvert$ 
                            by splines of degrees $0$, $1$, $0$, $1$, $0$ and $1$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with smoothness and interpolation constraints such that
                            the approximant is continuous and has values $10$, $-10$ and $10$ at points $-1/2$, $0$ and $1/2$ respectively.
                        </p>
                        <div class="code_box">F = -10*abs(x);
[e,P]=basc(F,[0 1 0 1 0 1],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3],<span class="string">'smoothness'</span>,[0 0 0 0 0],<span class="string">'interpolation'</span>, {{0, [-1/2 0 1/2; 10 -10 10]}});
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_14.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_spline_spline_diff_with">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the spline function $F(x) = -10\lvert x\rvert$ 
                            by splines of degrees $2$, $1$, $0$, $2$, $0$ and $2$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with smoothness and interpolation constraints such that
                            the approximant is differentiable and intersects with the target function at points $-1/2$ and $1/2$.
                        </p>
                        <div class="code_box">F = -10*abs(x);
[e,P]=basc(F,[2 1 0 2 0 2],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3],<span class="string">'smoothness'</span>,[1 1 1 1 1], <span class="string">'interpolation'</span>, {{0, [-1/2 1/2]}});
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_15.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div id="ig_polyn_spline_notcont_with">
                    <div class="body_content_container_container">
                        <p>
                            Here we approximate the function $F(x) = T_{10}(x)$ 
                            by splines of degrees $2$, $1$, $0$, $2$, $0$ and $2$ on intervals $[-1,-2/3]$, $[-2/3,-1/3]$, $[-1/3,0]$, $[0,1/3]$, 
                            $[1/3,2/3]$ and $[2/3,1]$ respectively in the max-norm with interpolation constraint such that
                            the approximant intersects the target function at points $0$ and $1/2$.
                        </p>
                        <div class="code_box">F = chebpoly(10);
[e,P]=basc(F,[2 1 0 2 0 2],<span class="string">'bkpts'</span>,[-2/3 -1/3 0 1/3 2/3], <span class="string">'interpolation'</span>, {{0, [0 1/2]}});
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>
                        <img align="middle" src="img/ig_images_16.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
            </div>
        </div>
        <!-- Examples (guide_examples)-->
        <div class="body_content_container">
            <h1 class="container_title" id="guide_examples">Examples</h1>
            <div class="content_box" id="examples_content_box">
                <p>
                    We illustrate below the use of <b>Basc</b>'s optional inputs with a number of simple examples.
                </p>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_norm">
                        <p>
                            <span class="exNum">1. </span>Here we approximate the function $F(x) = T_{10}(x)$ 
                            by polynomials of degree $n = 4$ in the 6-norm.
                        </p>
                        <div class="code_box">n = 4; F = chebpoly(10);
[e,P] = basc(F,n,<span class="string">'norm'</span>,6);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_01.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_weight">
                        <p>
                            <span class="exNum">2. </span>Here we approximate the function $F(x) = T_{10}(x)$ 
                            by polynomials of degree $n = 2$ in the max-norm with the weight $W(x) = x^2$.
                        </p>
                        <div class="code_box">n = 2; F = chebpoly(10);
[e,P] = basc(F,n,<span class="string">'weight'</span>,chebfun(<span class="string">'x.^2'</span>))
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_02.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_breakpoints">
                        <p>
                            <span class="exNum">3. </span>Here we approximate the function $F(x) = T_{10}(x)$ in the max-norm by a piecewise polynomial of degrees $1$, $4$, $1$, and $4$ on the intervals $[-1,-1/2]$, $[-1/2,0]$, $[0,1/2]$, and $[1/2,0]$, respectively.
                        </p>
                        <div class="code_box">F = chebpoly(10);
[e,P] = basc(F,[1 4 1 4],<span class="string">'bkpts'</span>,[-1/2 0 1/2])
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_03.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_smoothness">
                        <p>
                            <span class="exNum">4. </span>Here we approximate the function $F(x) = T_{10}(x)$ in the max-norm by splines of degrees $1$, $4$, $1$, and $4$ on the intervals $[-1,-1/2]$, $[-1/2,0]$, $[0,1/2]$, and $[1/2,0]$, respectively, in such a way that the approximant is continuous at $-1/2$ and $1/2$ and differentiable at $0$.
                        </p>
                        <div class="code_box">F = chebpoly(10);
[e,P] = basc(F,[1 4 1 4],<span class="string">'bkpts'</span>,[-1/2 0 1/2],<span class="string">'smoothness'</span>,[0 1 0])
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_04.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_parity">
                        <p>
                            <span class="exNum">5. </span>Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm by polynomials of degree $n \le 4$  that are even.
                        </p>
                        <div class="code_box">n = 4; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'parity'</span>,<span class="string">'even'</span>);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_05.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_interpolation0">
                        <p>
                            <span class="exNum">6. </span>Here we approximate the function $F(x) = T_5(x)$ in the max-norm by polynomials of degree $n \le 5$ with the interpolating constraint that the approximant vanishes at $-1/2$, $0$, and $1/2$.
                        </p>
                        <div class="code_box">n = 5; F = chebpoly(5);
[e,P]=basc(F, n, <span class="string">'interpolation'</span>, {{0, [-1/2 0 1/2; 0 0 0]}})
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_06.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_interpolation1">
                        <p>
                            <span class="exNum">7. </span>Here we approximate the function $F(x) = T_5(x)$ in the max-norm by polynomials of degree $n \le 4$ with the constraint that the approximant interpolates $F$ at $-1/2$, $0$, and $1/2$.
                        </p>
                        <div class="code_box">n = 4; F = chebpoly(5);
[e,P]=basc(F, n, <span class="string">'interpolation'</span>, {{0, [-1/2 0 1/2]}})
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_07.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_upper_range">
                        <p>
                            <span class="exNum">8. </span>Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm by polynomials of degree $n \le 3$  with the upper range constraint that the approximant is bounded above by $1-x^2$ and its derivative  is bounded above by $1$.
                        </p>
                        <div class="code_box">n = 3; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'upper range'</span>,{{0,chebfun(<span class="string">'1-x.^2'</span>)},{1,chebfun(<span class="string">'1'</span>)}})
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_08.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_lower_range">
                        <p>
                            <span class="exNum">9. </span>Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm by polynomials of degree $n \le 3$ with the lower range constraint that the approximant is bounded below by $x^2-1$ and its derivative is bounded below by $-1$.
                        </p>
                        <div class="code_box">n = 3; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'lower range'</span>,{{0,chebfun(<span class="string">'x.^2-1'</span>)},{1,chebfun(<span class="string">'-1'</span>)}})
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_09.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_shape">
                        <p>
                            <span class="exNum">10. </span>Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm by polynomials of degree $n \le 3$  with the shape constraint that the approximant is concave on $[-1,0]$ and convex on $[0,1]$.
                        </p>
                        <div class="code_box">n = 3; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'shape'</span>,{{2,chebfun(<span class="string">'x'</span>)}}')
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_10.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_obj_fun">
                        <p>
                            <span class="exNum">11. </span>Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ by polynomials of degree $n \le 3$ in the max-norm with objective function constraint such that
                            it has the weight $W_1(x)=1$ and its derivative has the weight $W_2(x)=1/3$.
                        </p>
                        <div class="code_box">n = 3; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'objective'</span>,{inf,{0,1},{1,1/3}})
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_11.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_side">
                        <p>
                            <span class="exNum">12. </span>Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm  by polynomials of degree $n \le 4$  with
                            the constraint that the approximant is larger than the target function.
                        </p>
                        <div class="code_box">n = 4; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'above'</span>)
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_12.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_sign">
                        <p>
                            <span class="exNum">13. </span>Here we approximate the function $F(x) = T_{10}(x)-0.5$ in the max-norm by polynomials of degree $n \le 3$  with
                            the constraint that the approximant is positive.
                        </p>
                        <div class="code_box">n = 3; F = chebpoly(10)-0.5;
[e,P] = basc(F,n,<span class="string">'positive'</span>)
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_18.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_monotonicity">
                        <p>
                            <span class="exNum">14. </span>Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm by polynomials of degree $n \le 3$  with
                            the constraint that the approximant is decreasing.
                        </p>
                        <div class="code_box">n = 3; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'decreasing'</span>)
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_13.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_concavity">
                        <p>
                            <span class="exNum">15. </span>Here we approximate the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm by polynomials of degree $n \le 3$  with the constraint that the approximant is convex.
                        </p>
                        <div class="code_box">n = 3; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'convex'</span>)
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_14.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_quiet">
                        <p>
                            <span class="exNum">16. </span>Here we display CVX's screen output when approximating the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm  by polynomials of degree $n \le 3$.
                        </p>    
                        <div class="code_box">n = 3; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'quiet'</span>,false)
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>
                        
                        <br>    
                        <div class="code_output_box">Calling SDPT3 4.0: 444 variables, 38 equality constraints
------------------------------------------------------------

 num. of constraints = 38
 dim. of sdp    var  = 84,   num. of sdp  blk  =  4
 dim. of socp   var  =  2,   num. of socp blk  =  1
*******************************************************************
   SDPT3: Infeasible path-following algorithms
*******************************************************************
 version  predcorr  gam  expon  scale_data
   HKM      1      0.000   1        0    
it pstep dstep pinfeas dinfeas  gap      prim-obj      dual-obj    cputime
-------------------------------------------------------------------
 0|0.000|0.000|3.3e+02|4.6e+01|2.7e+04| 2.121320e+00  0.000000e+00| 0:0:00| chol  1  1 
 1|1.000|0.040|2.1e-04|4.4e+01|2.6e+04| 4.189758e+02  8.288132e-02| 0:0:00| chol  1  1 
 2|1.000|0.982|2.3e-06|8.2e-01|6.7e+02| 2.081975e+02  1.789646e-01| 0:0:00| chol  1  1 
 3|0.989|0.993|6.2e-07|8.8e-03|1.7e+01| 1.268191e+01  3.704625e-01| 0:0:00| chol  1  1 
 4|0.907|0.995|4.3e-08|3.4e-04|2.3e+00| 3.558916e+00  1.438645e+00| 0:0:00| chol  1  1 
 5|0.953|0.814|2.7e-08|8.8e-05|8.6e-01| 3.327400e+00  2.605895e+00| 0:0:00| chol  1  1 
 6|0.949|0.874|1.5e-08|1.9e-05|8.2e-02| 2.871758e+00  2.814651e+00| 0:0:00| chol  1  1 
 7|0.835|1.000|4.2e-09|2.7e-06|2.0e-02| 2.844796e+00  2.828634e+00| 0:0:00| chol  1  1 
 8|0.982|0.942|4.2e-09|9.2e-07|2.0e-03| 2.838587e+00  2.837419e+00| 0:0:00| chol  1  1 
 9|0.985|0.988|4.8e-10|2.5e-07|1.4e-04| 2.838212e+00  2.838195e+00| 0:0:00| chol  1  1 
10|0.979|0.982|1.0e-11|4.7e-09|2.7e-06| 2.838206e+00  2.838205e+00| 0:0:00| chol  1  1 
11|1.000|0.984|1.5e-09|7.6e-11|8.3e-08| 2.838206e+00  2.838205e+00| 0:0:00|
  stop: max(relative gap, infeasibilities) < 1.49e-08
-------------------------------------------------------------------
 number of iterations   = 11
 primal objective value =  2.83820550e+00
 dual   objective value =  2.83820546e+00
 gap := trace(XZ)       = 8.33e-08
 relative gap           = 1.25e-08
 actual relative gap    = 6.43e-09
 rel. primal infeas (scaled problem)   = 1.48e-09
 rel. dual     "        "       "      = 7.60e-11
 rel. primal infeas (unscaled problem) = 0.00e+00
 rel. dual     "        "       "      = 0.00e+00
 norm(X), norm(y), norm(Z) = 3.6e+02, 3.0e+00, 4.2e+00
 norm(A), norm(b), norm(C) = 9.4e+00, 2.2e+00, 2.0e+00
 Total CPU time (secs)  = 0.22  
 CPU time per iteration = 0.02  
 termination code       =  0
 DIMACS: 2.2e-09  0.0e+00  7.6e-11  0.0e+00  6.4e-09  1.2e-08
-------------------------------------------------------------------
 
------------------------------------------------------------
Status: Solved
Optimal value (cvx_optval): +2.83821
 

e =

    2.8382


P =

   chebfun column (1 smooth piece)
       interval       length   endpoint values  
[      -1,       1]        4       3.2      5.2 
Epslevel = 1.110223e-15.  Vscale = 7.324816e+00.
                        </div><br>

                        <img align="middle" src="img/examples_images_15.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_precision">
                        <p>
                            <span class="exNum">17. </span>Here we use CVX's high precision when approximating the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm by polynomials of degree $n \le 3$.
                        </p>    
                        <div class="code_box">n = 3; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'precison'</span>,<span class="string">'high'</span>)
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_16.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                
                <div class="body_content_container_container">
                    <div class="content_content_box" id="examples_solver">
                        <p>
                            <span class="exNum">18. </span>Here we select the solver SeDuMi for CVX when approximating  the function $F(x) = T_{10}(x)+T_9(x)+T_8(x)+5$ in the max-norm by polynomials of degree $n \le 3$.
                        </p>     
                        <div class="code_box">n = 3; F = chebpoly(10)+chebpoly(9)+chebpoly(8)+5;
[e,P] = basc(F,n,<span class="string">'solver'</span>,<span class="string">'sedumi'</span>);
set(figure(1),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <a style="float: right;" onclick="
                        $('#guide_parameter_desc').parent('div.body_content_container').find('div.content_box').slideDown(50);
                        $('#guide_examples').parent('div.body_content_container').find('div.content_box').slideDown(0);
                        $(window).scrollTop($('#guide_parameter_desc').offset().top);$('#examples_content_box').slideUp(0);">back to description</a>

                        <img align="middle" src="img/examples_images_17.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
            </div>
        </div>
        <!-- Advanced Examples (guide_advanced_examples)-->
        <div class="body_content_container">
            <h1 class="container_title" id="guide_advanced_examples">Advanced Examples</h1>
            <div class="content_box">
                <p>
                    The following examples are the ones included in the publication [1].<br>
                </p>
                <div class="body_content_container_container">
                    <h2 class="container_container_title">One-sided polynomial approximation</h2>
                    <div class="content_content_box">
                        <p>
Here we approximate the function $F(x) = \frac{T_5(x)}{4+\cos(x)+\sin(x)}$ 
by polynomials of degree $n \le 4$ in the max-norm and in the 2-norm,
and we also incorporate the constraints that the approximant is
smaller/larger than the target function, 
i.e., we consider approximation from below/above.
The leftmost graph shows the target function and the unconstrained
approximants.
The middle graph displays the differences between the target function and
the max-norm approximants:
one recognizes the equioscillation property for the unconstrained
approximation and one also observes that the one-sided approximants are
just shifted versions of the unconstrained approximant
(a fact that is easy to establish).
The rightmost graph reveals that such a phenomenon does not occur for the
2-norm.
                        </p>

                        <div class="code_box">n = 4; F = chebpoly(5)./(4+cos(x)+sin(x));
[e,P] = basc(F,n); [e2,P2] = basc(F,n,<span class="string">'norm'</span>,2);
[ea,Pa] = basc(F,n,<span class="string">'above'</span>); [ea2,Pa2] = basc(F,n,<span class="string">'above'</span>,<span class="string">'norm'</span>,2);
[eb,Pb] = basc(F,n,<span class="string">'below'</span>); [eb2,Pb2] = basc(F,n,<span class="string">'below'</span>,<span class="string">'norm'</span>,2);

set(figure(1),POS,pos);
subplot(1,3,1); plot(F,<span class="string">'x-k'</span>,P,<span class="string">'s--g'</span>,P2,<span class="string">'o:m'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>,<span class="string">'best max-norm approx.'</span>,<span class="string">'best 2-norm approx.'</span>),FS,fs,LOC,loc,BX,bx);
subplot(1,3,2); plot(F-P,<span class="string">'s--g'</span>,F-Pa,<span class="string">'x-y'</span>,F-Pb,<span class="string">'d-.b'</span>,LW,lw);
set(legend(<span class="string">'max-norm approx. error'</span>,<span class="string">'from above'</span>,<span class="string">'from below'</span>),FS,fs,LOC,loc,BX,bx);
subplot(1,3,3); plot(F-P2,<span class="string">'o:m'</span>,F-Pa2,<span class="string">'x-c'</span>,F-Pb2,<span class="string">'d-.r'</span>,LW,lw);
set(legend(<span class="string">'2-norm approx. error'</span>,<span class="string">'from above'</span>,<span class="string">'from below'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <img align="middle" src="img/reproducible_01.png" style="height: auto;max-width: 100%;margin: 20px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <h2 class="container_container_title">Weighted and interpolatory polynomial approximation</h2>
                    <div class="content_content_box">
                        <p>
With a different target function and approximant degree,
the experiment below shows how to compute the best unconstrained approximant
and the best odd approximant relative to a weighted max-norm. 
It also shows how to compute the best approximant under interpolatory conditions
at the endpoints, still relative to the weighted max-norm.
Note that the weight $W(x) = x^2$ vanishes two-fold at $x=0$,
which forces the approximant to agree two-fold with the target function
at $x=0$.
This is indeed verified by the examples considered here.
                        </p>

                        <div class="code_box">n = 5; F = chebpoly(7)./(4+cos(x)+sin(x));
[ew,Pw] = basc(F,n,<span class="string">'weight'</span>,x.^2);
[ewo,Pwo] = basc(F,n,<span class="string">'weight'</span>,x.^2,<span class="string">'parity'</span>,<span class="string">'odd'</span>);
[ewi,Pwi] = basc(F,n,<span class="string">'weight'</span>,x.^2,<span class="string">'interpolation'</span>,{{0,[-1 1]}});

set(figure(2),POS,pos);
subplot(1,2,1); plot(F,<span class="string">'x-k'</span>,Pw,<span class="string">'d-.b'</span>,Pwo,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best weighted approx.'</span>, <span class="string">'best weighted odd approx.'</span>),...
FS,fs,LOC,loc,BX,bx);
subplot(1,2,2); plot(F,<span class="string">'x-k'</span>,Pwi,<span class="string">'o:r'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'best weighted interpolatory approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <img align="middle" src="img/reproducible_02.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <h2 class="container_container_title">Approximation by splines</h2>
                    <div class="content_content_box">
                        <p>
We now consider the approximation in the max-norm by splines, 
i.e., piecewise polynomials satisfying some smoothness conditions at the
breakpoints.
In the first example below, a polynomial of degree $2n$ is approximated
by splines of degree $2n-1$ with one breakpoint at $x=0$.
No smoothness condition is imposed at this breakpoint,
in other words, the spline is a priori $C^{-1}$ there,
but one notices that it is in fact automatically $C^0$
(a fact that can be verified theoretically).
For comparison, the best $C^1$ spline approximant is also displayed.
                        </p>

                        <div class="code_box">n = 2; F = chebfun(rand(2*n+1,1),<span class="string">'coeffs'</span>);
[es,Ps] = basc(F,2*n-1,<span class="string">'bkpts'</span>,[0],<span class="string">'smoothness'</span>,[-1]);
[es2,Ps2] = basc(F,2*n-1,<span class="string">'bkpts'</span>,[0],<span class="string">'smoothness'</span>,[1]);

set(figure(3),POS,pos);
plot(F,<span class="string">'x-k'</span>,Ps,<span class="string">'d-.b'</span>,Ps2,<span class="string">'s--g'</span>,<span class="string">'interval'</span>,[-0.4 0.4],LW,lw);
set(legend(<span class="string">'target function'</span>,<span class="string">'C^{-1}-spline approx.'</span>,<span class="string">'C^1-spline approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <img align="middle" src="img/reproducible_03.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                        <p>
In the next example of spline approximation,
the target function is a spline itself:
it is taken to be the prototypical absolute value function.
We compute its best max-norm approximants by splines 
with breakpoints at $x=-1/2$ and $x=1/2$ and whose three polynomial pieces 
have degree $1$, $2$, and $1$, respectively.
One approximant has smoothness $C^0$ at both breakpoints -- this example
incidentally reveals that best approximants are not always unique,
as perturbing the slopes of the outside pieces does not affect the
overall error.
Another approximant has maximal (meaning $C^1$ here) smoothness at both
breakpoints.
The last approximant obeys an extra constraint besides maximal smoothness, 
namely its derivative is lower bounded by the function $L(x)=-1/2$.
                        </p>

                        <div class="code_box">F = abs(x);
[e0,P0] = basc(F,[1 2 1],<span class="string">'bkpts'</span>,[-1/2 1/2],<span class="string">'smoothness'</span>,[0 0]);
[e1,P1] = basc(F,[1 2 1],<span class="string">'bkpts'</span>,[-1/2 1/2],<span class="string">'smoothness'</span>,<span class="string">'maximal'</span>);
[elr,Plr] = basc(F,[1 2 1],<span class="string">'bkpts'</span>,[-1/2 1/2],<span class="string">'smoothness'</span>,<span class="string">'maximal'</span>,<span class="keyword">...</span>
  <span class="string">'lower range'</span>,{{1,chebfun(-0.5)}});

set(figure(4),POS,pos);
plot(F,<span class="string">'x-k'</span>,P0,<span class="string">'d-.b'</span>,P1,<span class="string">'s--g'</span>,Plr,<span class="string">'o:r'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>, <span class="string">'C^0-approx.'</span>,<span class="string">'C^1-approx.'</span>,<span class="string">'lower-ranged C^1-approx'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <img align="middle" src="img/reproducible_04.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <h2 class="container_container_title">Bernstein-type constants</h2>
                    <div class="content_content_box">
                        <p>
Here we look at the rate $E_n(|\cdot|)$ of approximation error to the absolute value
function in the max-norm by polynomials of degree $\le n$.
It is a classical fact that
$$ \beta := \lim_{n \to \infty} n E_n(|\cdot|) $$
exists. 
This result is due to Bernstein, who conjectured the value $\frac{1}{2 \sqrt{\pi}}$ for $\beta$.
This was disproved by Varga and Carpenter who obtained the value
$$ \beta \approx 0.280169499023. $$
Furthermore, it is known that
$$ \beta^{\rm conv} := \lim_{n \to \infty} n E_n^{\rm conv}(|\cdot|) $$
exists, too.
Below, we verify the behavior of $E_n(|\cdot|)$ and investigate that of
$E_n^{\rm conv}(|\cdot|)$.
Before doing so, let us see what the best approximant, the best convex
approximant, and the best [convex-on-concave-outside-$[-2/3,2/3]$] approximant to $|\cdot|$
look like when $n=5$.
                        </p>

                        <div class="code_box">n = 5; F = abs(x);
[e,P] = basc(F,n);
[econv,Pconv] = basc(F,n,<span class="string">'convex'</span>);
[econv2,Pconv2] = basc(F,n,<span class="string">'shape'</span>,{{2,-(x.^2-4/9)}});

set(figure(5),POS,pos);
plot(F,<span class="string">'x-k'</span>,P,<span class="string">'d-.b'</span>,Pconv,<span class="string">'o:r'</span>,Pconv2,<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'target function'</span>,<span class="string">'best approx.'</span>,<span class="string">'best convex approx.'</span>,<span class="keyword">...</span>
  <span class="string">'best partially convex approx.'</span>),FS,fs,LOC,loc,BX,bx);</div>

                        <img align="middle" src="img/reproducible_05.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                        <p>
We continue with the calculation of $E_n(|\cdot|)$ and of 
$E_n^{\rm conv}(|\cdot|)$ for values of even $n$ 
up to $n = 26$ and $n = 18$, respectively,
and we report their behaviors in the graph below.
Note that we used a customized code for the convex approximation
in order to increase the range of computable $n$.
                        </p>

                        <div class="code_box">beta = 0.280169499023;
<span class="keyword">for</span> n = 2:2:26; B(n) = n*basc(F,n); <span class="keyword">end</span>
<span class="keyword">for</span> n = 2:2:18; Bcvx(n) = Bernstein_conv(n); <span class="keyword">end</span>

set(figure(6),POS,pos);
subplot(1,2,1); plot(2:2:26,B(2:2:26),<span class="string">'d-.b'</span>,2:2:26,beta*ones(1,13),<span class="string">'o:r'</span>,LW,lw);
set(legend(<span class="string">'n E_n(|.|)'</span>,<span class="string">'\beta'</span>),FS,fs,LOC,loc,BX,bx); xlabel(<span class="string">'n'</span>);
subplot(1,2,2); plot(2:2:18,Bcvx(2:2:18),<span class="string">'s--g'</span>,LW,lw);
set(legend(<span class="string">'n E_n^{conv}(|.|)'</span>),FS,fs,LOC,loc,BX,bx); xlabel(<span class="string">'n'</span>);</div>

                        <img align="middle" src="img/reproducible_06.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
                <div class="body_content_container_container">
                    <h2 class="container_container_title">Natural cubic spline</h2>
                    <div class="content_content_box">
                        <p>
Given nodes $-1 = t_0 &lt; t_1 &lt; \cdots &lt; t_{M-1} &lt; t_M = 1$
and data $y_0,y_1,\ldots,y_{M-1},y_M$,
the natural cubic spline is the $C^2$ function that minimizes $\|P''\|_2$
subject to the interpolatoty conditions $P(t_i) = y_i$ for all $i$.
This function has breakpoints at $t_1,\ldots,t_{M-1}$,
its pieces all have degree $\le 3$,
and it satisfies $P''(t_0)=0$ and $P''(t_M)=0$.
We minimize not over all $C^2$ functions,
but over all $C^2$ splines of degree $5$ with breakpoints $t_1,\ldots,t_{M-1}$
and we verify below that the second derivative of the minimizer is indeed
a continuous linear function vanishing at the endpoints.
                        </p>
                        <div class="code_box">t = [-1/3 1/3]; s = [2 2]; n = 5;
[e,P] = basc(chebfun(0),n,<span class="string">'objective'</span>,{inf,{2,1}},<span class="string">'norm'</span>,2,<span class="string">'bkpts'</span>,t,<span class="keyword">...</span>
  <span class="string">'smoothness'</span>,s,<span class="string">'interpolation'</span>,{{0,[-1 t 1;1 2 0 1]},{2,[-1 1;0 0]}});

set(figure(7),POS,pos);
subplot(1,2,1); plot(P,<span class="string">'d-.b'</span>,LW,lw); hold <span class="string">on</span>; plot([-1 t 1],[1 2 0 1],<span class="string">'xk'</span>,LW,2*lw);
title(<span class="string">'A natural cubic spline'</span>,FS,fs);
subplot(1,2,2); plot(diff(P,2),<span class="string">'o:r'</span>,LW,lw);
title(<span class="string">'Second derivative of the natural cubic spline'</span>,FS,fs);</div>

                        <img align="middle" src="img/reproducible_07.png" style="height: auto;max-width: 100%;margin: 0px auto;" />
                    </div>
                </div>
            </div>
        </div>
        <!-- References (guide_references)-->
        <div class="body_content_container">
            <h1 class="container_title" id="guide_references">References</h1>
            <div class="content_box">
                <p>
1. S. Foucart and V. Powers, <a href="BascPapers/ConstrApprox.pdf">"Basc: constrained approximation by semidefinite programming"</a>.<br><br>
2. CVX Research, Inc., "CVX: MATLAB software for disciplined convex programming, version 2.1", 2014, <a href="http://cvxr.com/cvx">http://cvxr.com/cvx</a>.<br><br>
3. L. N. Trefethen et al., "Chebfun Version 5, The Chebfun Development Team", 2014, <a href="http://www.chebfun.org">http://www.chebfun.org</a>.<br>
                </p>
            </div>
        </div>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'https://ssl':'https://www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>
    </body>
</html>
